<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Новости</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body>
    <div class="max-w-4xl mx-auto p-4">
        <header class="mb-6">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold">Новости 1.0.0</h1>
                <div class="space-x-2">
                    <span sec:authorize="isAuthenticated()" class="text-sm text-gray-600">
                        Добро пожаловать, <span sec:authentication="name"></span>!
                    </span>
                    <a sec:authorize="isAuthenticated()" href="/posts/create" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Создать пост</a>
                    <a sec:authorize="isAuthenticated()" href="/logout" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Выйти</a>
                    <a sec:authorize="!isAuthenticated()" href="/login" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Войти</a>
                </div>
            </div>
        </header>

        <div th:if="${#lists.isEmpty(posts)}" class="text-center py-8 text-gray-500">
            <p>Пока нет постов</p>
        </div>
        
        <div th:each="post : ${posts}" class="bg-white border rounded-lg p-4 mb-4 shadow-sm">
            <div class="flex justify-between items-center mb-2">
                <strong th:text="${post.authorUsername}">Автор</strong>
                <span class="text-sm text-gray-500" th:text="${#temporals.format(post.createdAt, 'dd.MM.yyyy HH:mm')}">Дата</span>
            </div>
            <h2 class="text-xl font-semibold mb-2" th:text="${post.title}">Заголовок</h2>
            <p class="text-gray-700" th:text="${post.content}">Содержание</p>
        </div>

        <div th:if="${totalPages > 1}" class="flex justify-center space-x-2 mt-6">
            <a th:if="${hasPrevious}" th:href="@{/(page=${currentPage - 1}, size=${size})}" class="bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">Назад</a>
            <span th:each="pageNum : ${#numbers.sequence(0, totalPages - 1)}" 
                  th:if="${pageNum >= currentPage - 2 and pageNum <= currentPage + 2}">
                <a th:if="${pageNum != currentPage}" th:href="@{/(page=${pageNum}, size=${size})}" class="bg-gray-200 px-3 py-1 rounded hover:bg-gray-300" th:text="${pageNum + 1}"></a>
                <span th:if="${pageNum == currentPage}" class="bg-blue-500 text-white px-3 py-1 rounded" th:text="${pageNum + 1}"></span>
            </span>
            <a th:if="${hasNext}" th:href="@{/(page=${currentPage + 1}, size=${size})}" class="bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">Далее</a>
        </div>
    </div>
</body>
</html>
